%% Test turn_flight
clear
% Inputs
Pos = [0;0;0];
Vel = [46;0;0];
radius = 1200;
time = 40;

% Run and plot the turn
newPos = turn_flight(Pos, Vel, radius, time);
plot3(newPos(1,:), newPos(2,:), newPos(3,:))

% Compare to solution
solution = [0,18.3978370201567,36.7891856093139,55.1697218417881,73.5351243339508,91.8810752602145,110.203261368181,128.497374992717,146.759115068710,164.984188142281,183.168309380203,201.307203577289,219.396606161525,237.432264196698,255.409937382287,273.325399050385,291.174437159422,308.952855284433,326.656473603674,344.281129881322,361.822680446042,379.277001165193,396.639988414441,413.907560042540,431.075656331081,448.140240948952,465.097301901310,481.942852472825,498.672932164981,515.283607627218,531.770973581687,548.131153741408,564.360301721606,580.454601944026,596.410270533995,612.223556210042,627.890741165844,643.408141944306,658.772110303570,673.979034074736,689.025338011109,703.907484628761,718.621975038219,733.165349767074,747.534189573326,761.725116249273,775.734793415745,789.559927306510,803.197267542663,816.643607896808,829.895787046862,842.950689319305,855.805245421696,868.456433164279,880.901278170523,893.136854576419,905.160285718362,916.968744809484,928.559455604241,939.929693051132,951.076783933371,961.998107497385,972.691096068964,983.153235656938,993.382066544239,1003.37518386619,1013.13023817590,1022.64493599666,1031.91704036111,1040.94437133720,1049.72480654071,1058.25628163420,1066.53679081239,1074.56438727370,1082.33718367798,1089.85335259025,1097.11112691030,1104.10880028818,1110.84472752536,1117.31732496153,1123.52507084693,1129.46650570013,1135.14023265114,1140.54491776985,1145.67929037964,1150.54214335610,1155.13233341087,1159.44878136041,1163.49047237973,1167.25645624099,1170.74584753687,1173.95782588878,1176.89163613973,1179.54658853185,1181.92205886854,1184.01748866129,1185.83238526092,1187.36632197344,1188.61893816034,1189.58993932341,1190.27909717397;0,0.282122278016382,0.846300505266460,1.69240203977919,2.82022795758017,4.22951309945993,5.91992613331463,7.89106963204436,10.1424801669909,12.6736284168926,15.4839192923316,18.5726920756429,21.9392205762536,25.5827133014150,29.5023136422874,33.6971000753349,38.1660863789811,42.9082218654767,47.9223916279224,53.2074168023916,58.7620548450880,64.5849998244765,70.6748827283159,77.0302717855226,83.6496728027892,90.5315295158793,97.6742239555152,105.076076827773,112.735347908895,120.650236454430,128.818881622595,137.239362911778,145.909700612055,154.827856270633,163.991733171108,173.399176826412,183.047975485349,192.935860652592,203.060507622019,213.419536023272,224.010510381389,234.830940689408,245.878282993780,257.149939992469,268.643261645596,280.355545798481,292.284038816932,304.425936234651,316.778383412575,329.338476210023,342.103261667479,355.069738700850,368.234858807043,381.595526780686,395.148601441830,408.890896374464,422.819180675660,436.930179715179,451.220575905358,465.687009481099,480.326079289769,495.134343590831,510.108320865025,525.244490632894,540.539294282467,555.989135905919,571.590383144987,587.339368044964,603.232387917057,619.265706208915,635.435553383115,651.738127803407,668.169596628500,684.726096713192,701.403735516618,718.198592017411,735.106717635563,752.124137160759,769.246849686975,786.470829553117,803.792027289482,821.206370569813,838.709765168730,856.298095924306,873.967227705576,891.713006384725,909.531259813753,927.417798805377,945.368418117934,963.378897444060,981.445002402911,999.562485535698,1017.72708730429,1035.93453709265,1054.18055421090,1072.46084890173,1090.77112334895,1109.10707268794,1127.46438601774,1145.83874741457,1164.22583694655;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
diff = max(abs(newPos - solution), [], 'all');
assert( diff <= 1e-1 )
